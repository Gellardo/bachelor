\chapter{Differential Geometry}
\label{chapter:differentialGeometry}

\section{Regular Surfaces and the First Fundamental Form}
%% TODO differentiable mapping
\begin{mydef}[regular surface]
	differentiable mapping going from a parameter domain to a subset $S \in \real^3$ with the following properties:
\end{mydef}
\section{Minimal Geodesics on Surfaces}
One of the most fundamental metrics is the idea of constructing the shortest path between two points and define the length of that path as the distance between those two points.
In the euclidean domain, this metric is defined by the euclidean norm of the vector joining the two points.
On a regular surface, defining this distance is not as easy, since a lower dimensional set is embedded into a higher dimension.
The basic idea is, to find the shortest path along the surface from one point to the other and take its length as the distance.
It is commonly known, that such a path is a straight line and its generalisation to curved surfaces is called a minimal geodesic, which will be defined during the course of this section.

Since a geodesic is definitly some kind of curve, we start by introducing the core concepts needed for the definition of a geodesic.
\begin{mydef}[parametrized curve]
	A parametrized curve $\alpha$ is the restriction of a differentiable mapping $( 0-\epsilon, l+\epsilon) \rightarrow S), \epsilon > 0$ to the intervall $[0,l]$.
	The curve $\alpha$ is called to join two points $p,q \in S$ if and only if $\alpha(0) = p$ and $\alpha(l) = q$ and it is called regular, if its derivative $\alpha'(t)$ is nonzero for $t \in [0,l]$.
\end{mydef}
Now let $w(t)$ be a vectorfield along the curve $\alpha$.
Then $w$ is called differentiable, if for the parametization $x(u,v)$ the vector field $w(t)$ can be written as $w(t) = a(t) \cdot x_u + b(t) \cdot x_v$, where $a$ and $b$ are differentiable functions.
Another important part is the covariant derivative of a vectorfield.
\begin{mydef}[covariant derivative]
	Let $\alpha(t)$ be a parametrized curve on $S$ with $\alpha(0) = p \in S, \alpha'(0) = y \in T_pS$ and a differential vector field $w(t)$ constricted to $\alpha$.
	The normal projection of the derivative of $w$ in respect to time $\frac{dw}{dt}(0)$ onto the tangent space $T_pS$ is called the covariant derivative at $p$ of the vector field $w$ relative to $y$:$\frac{Dw}{dt}(0)$
\end{mydef}
The covariant derivative is well-defined for differentiable vectorfields and is furthermore intrinsic.
This can be seen, if we look at the expression for the covariant derivative:
$$\frac{Dw}{dt} = (a' + \Gamma^{1}_{1 1} a u' + \Gamma^{1}_{1 2} a v' + \Gamma^{1}_{1 2} b u' + \Gamma^{1}_{2 2} b v')x_u + (b' + \Gamma^{2}_{1 1} a u' + \Gamma^{2}_{1 2} a v' + \Gamma^{2}_{1 2} b u' + \Gamma^{2}_{2 2} b v')x_v$$
where $(u' v') = y$  and the $\Gamma$ are the so called Christoffel symbols, which are only dependent on first fundamental form and therefore $\frac{Dw}{dt}$ is an intrinsic property of the suface as shown in chapter 4.3 of \cite{do1976differential}.
A geometric interpretation of the covariant derivative would be the second derivative of the vectorfield $w$ as seen from the surface.
\begin{mydef}[parallel vectorfield]
	The vectorfield $w$ along the parametrized curve $\alpha$ is called parallel if it satisfies
	$$\frac{Dw}{dt} = 0 $$
	for all points on $\alpha$.
\end{mydef}

%% picture
Now every aspect of the following definition has been introduced:
\begin{mydef}[geodesic curve]
	A nonconstant, parametrized curve $\gamma: I \rightarrow S$ is called geodesic at $t \in I$ if the field of its tangentvectors $\gamma'(t)$ is parallel along $\gamma$ at $t$.
	Consequently, the curve $\gamma$ is called geodesic, if $\frac{D\gamma'}{dt} = 0 \forall t \in I$.
\end{mydef}
\cite[238-246]{do1976differential}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TODO example?
If we look at a sphere $S^2$, its geodesic curves are obtained by intersecting the sphere with a plane passing through the centerpoint of the sphere.
So there are at least two geodesics joining two points $p_1$ and $p_2$, just by following the intersection into different directions, starting from $p_1$.
																							%%% noch zu erklÃ¤ren %%%%
To be a minimal geodesic, the curves length has to be less or equal to the length of any other piecewise regular curve on the surface.
On the $S^2$ this would be the shorter arc joining $p_1$ and $p_2$ or, if they are antipodal points like the north and the south pole, there is an infinite number of minimal geodesics joining $p_1$ and $p_2$.
On the other hand, the existance of a minimal geodesic is not granted:
Let $p$ be a point on the minimal geodesic joining the points $p_1$ and $p_2$ (which are not a pair of antipodal points/sufficiently close) on the sphere $S^2$ and let the surface be $S^2-{p}$.
Then there exists no minimal geodesic between $p_1$ and $p_2$, since the only other geodesic joining them goes the long way around and is therefore longer than a piecewise regular curve almost equal to the minimal geodesic on $S^2$ except for going around the hole at $p$.
%%picture?
One way to ensure the existance of a minimal geodesic is to constrain the surfaces to have certain properties.
%5.3 -P5 every compact surface is complete -> compact (closed and bounded [not inf]112 im text) also
%complete?
In general, most of the surfaces examined are both closed and bounded wich means, they are compact.
As shown in \cite[331-332]{do1976differential}, compact surfaces are complete and we can use the theorem of Hopf and Rinow: \\
\begin{theorem}
	``Let S be a complete surface. Given two points $p,q$, there exists a minimal geodesic joining $p$ and $q$.'' \cite[333]{do1976differential} \\
\end{theorem}
Hence we can safely assume that there exists a minimal geodesic on the regular surfaces considered.
This approach is not very practical on actual meshes, since it needs a parametrisation of the surface and comparing the length of all possible geodesic curves is not practical.

\subsection*{Discretisation to triangulated meshes}
There are two main ways to compute shortest geodesic paths on triangulated meshes: One is solving the Eikonal equation with the Fast Marching Method to aproximate geodesics on the mesh.
The second way, which will be used later in this paper, has been proposed by Mitchel, Mount and Papadimitriou (MMP) in 1987.
Its fundamental idea is to use a simple parametrisation of the geodesic distance on each edge and propagate the distance information starting from the source point over the whole surface.
Take note, that geodesics on a triangular mesh need to have two properties:
\begin{itemize}
	\item They need to be straigth lines within each face.
	\item When crossing over an edge, the shortest paths need to correspond to a straight line if the faces are unfolded into a common plane.
\end{itemize}
Additionally, there are two kinds of vertices which need additional attention: boundary vertices and saddle vertices, which have a total angle greater than $2\pi$.
With this in mind, we can take a look at the MMP algorithm.
The main element of this are the so called windows, which bundle multiple shortest paths that traverse an edge into the same direction, into one tuple of six parameters.
%% need pictures of the different parameters + small picture for pseudo sources+distances

\paragraph{The window parameters}
Let's first assume, that the shortest path from the source vertex $v_s$ to the point $p$ does not pass through any boundary or saddle vertices.
In that case, all traversed triangles can be unfolded into a common plane, so that the path is a straight line in that plane.
If we now consider some neighboring points of $p$ whose shortest paths pass through the same sequence of faces, we get at set of straight lines emanating from $v_s$ intersecting the same edges.
So these paths are combined into one window and it is saved for the edge $e$ by first defining its width through determining the beginning and the end point of the window by $b_0, b_1 \in [0,||e||]$.
Additionally, the relative position of the source vertex to the window is encoded by the distance $d_0,d_1$ to the two window endpoints and a binary direction $\tau$.
In the case, that the path passes through one or more saddle/boundary vertices, let $s$ be the one closest to $p$.
All paths of $p$ and its neighboring points pass through $s$, which therefore is a (pseudo-)source for them.
The window now stores the distance information to $s$ as its source and an additional parameter that contains the distance of $s$ from $v_s$: $\sigma = D(s)$.
So the distance field $D$ over the window is described by the tuple $(b_0,b_1,d_0,d_1,\sigma,\tau)$.

\paragraph{Window propagation}
%% pictures of the propagation process (1,2,4 new windows)
To compute the distance function over the whole mesh, the windows are propagated over it.
Given a window $w$ on the edge $e_1$, the distance field will be propagated over a adjacent face $f$, resulting in new windows on the opposing edges $e_2,e_3$ of that face.
Since there are possibly already existing windows on those edges, we later need to intersect them with the existing ones and only keep the information of the shortest distances.
After again unfolding the mesh into a common plane, we extend the connections of the endpoints of $w$ and the source $s$ until they intersect with one of the opposing edges.
This results in either one or two new windows, depending if there is an vertex in between the two intersection points.
Now we already have the values of $ b_0', b_1'$ of the new window and only need to compute the new distances to the endpoints $d_0',d_1'$.
The pseudosource distance $\sigma' = \sigma$ stays the same and the direction $\tau$ is assigned to point into the face $f$.

The special case of $w$ being adjacent to a saddle/boundary vertex $v$ results in a few additional windows.
Since shortest paths may pass through $v$, we need to add windows to the parts of the face, which can be reached through $v$ and is not already taken care of by the preceding steps.
%% todo more about this, once i have an illustration

\paragraph{Intersection of windows}
Once all new windows were created, we can intersect them with the existing ones, resulting in windows with the minimal distance.
Let $\delta$ be the non-empty intersection interval of two windows $w_1$ and $w_2$.
In the simple case, that one of the windows has a larger distance all over $\delta$, then $\delta$ is just cut away from its interval.
This leaves only intersections, were one window has a shorter distance on one end, while the other window is nearer to the source on the other end.
To intersect those two windows, we need to find the point $p \in \delta$  in between them, which is exactly as far away from the source in one window, as it is in the other.
This means, that $p$ has to fullfill the following condition:
$$||s_0 - p|| + \sigma_0 = ||s_1 - p|| + \sigma_1$$
This equation can be reduced to a quadric which has only one solution with the constraint $p \in \delta$.
Finally, we only need to adjust the boundarys $b_1$ of $w_1$ and $b_0$ of $w_2$ to match the point $p$ and recompute the endpoint distances.

\paragraph{Propagation order}
The described algorithm propagates the distance information from the source point outwards in a Dijkstra-like manner.
This means, that every time, a window is created or modified, it will be placed in a priority queue from which then the first window is taken and propagated across a face next.
Even though the algorithm computes the same result even without an specific ordering of the queue, the performance is increased, if the queue is ordered by the windows distance from the source.
Notice, that windows can be added, modified and removed in one step and the queue has to be updated accordingly.

During initialization, on each edge adjacent to the source vertex $v_s$ a window is created.
The distance fields on those windows are trivial, e.g. the distance every vertex adjacent to $v_s$ is equal to the edge length.
After that, one window is popped of the priority queue in each step and processed.

\cite{surazhsky2005fast}

\section{The Laplacian and Metrics based on its Eigenfunctions}
